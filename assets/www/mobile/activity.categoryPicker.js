"use strict";templates=templates||{};templates.mobile=templates.mobile||{};templates.mobile.activity=templates.mobile.activity||{};templates.mobile.activity.categoryPicker=templates.mobile.activity.categoryPicker||{};(function(){var h=devhd.i18n.L,a=devhd.i18n.$L,e=[],f="",i=templates.mobile.activity.categoryPicker;function g(l){var k=arguments,j;for(j=1;
j<k.length;j++){l.push(k[j])}}function d(j){try{if(j==null){return""}if(typeof j!="string"){return j}if(typeof j.replace!="function"){return j}return j.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")}catch(k){return""}}function c(j){if(j==null){return""}if(typeof j!="string"){return j}if(typeof j.replace!="function"){return j}return j.replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\\/g,"\\\\").replace(/\"/g,"&quot;").replace(/[\f\r\t\n]/g," ").replace(/\</g,"&lt;").replace(/\>/g,"&gt;")
}function b(j){if(aString==null){return null}return aString.replace(/<\/?[^>]+>/gi,"")}i.css=function(k){var j=[];g(j,e[0],PANEL_W,e[1],PANEL_W,e[2],3*PAD,e[3],feedlyTheme.se_back,e[4],feedlyTheme.se_color,e[5],NAVIGATION_BAR==60?18:14,e[6],family("regular"),e[7],feedlyTheme.se_color,e[8],feedlyTheme.se_header,e[9],-LIST_BAR-1,e[10],3*PAD,e[11],LIST_BAR,e[12],PAD,e[13],PANEL_W,e[14],feedlyTheme.se_color,e[15],LIST_BAR,e[16],PANEL_W-80,e[17],LIST_BAR,e[18],feedlyTheme.accent,e[19],LIST_BAR,e[20],LIST_BAR,e[21],feedlyTheme.se_color,e[22],feedlyTheme.se_block,e[23],PAD,e[24],PAD,e[25],family("regular"),e[26],feedlyTheme.se_border,e[27],feedlyTheme.se_border,e[28],PAD,e[29],PAD,e[30],PAD,e[31],feedlyTheme.se_object,e[32],PAD,e[24],PAD,e[33],LIST_BAR,e[34],svg(themable("mobile-icon-collection")),e[35],Math.floor(LIST_BAR-16)/2,e[36],Math.floor(LIST_BAR-16)/2,e[37]);
return j.join(f)};i.layout=function(j){var k=[];g(k,e[38],feedlyTheme.se_highlight,e[39],2*PAD,e[40],PAD,e[41],feedlyTheme.se_highlight,e[42],LIST_BAR,e[43],6*PAD,e[44]);return k.join(f)};i.object=function(k){var j=[];g(j,e[45],k,e[45]);return j.join(f)};i.layoutOptions=function(k){var j=[];for(var l=0;l<k.length;l++){g(j,e[46],k[l].label,e[47],feedlyTheme.se_highlight,e[48],k[l].label,e[49])
}return j.join(f)};i.suggestion=function(j){var k=[];g(k,e[50],2*PAD,e[51],2*PAD,e[52],j,e[53]);return k.join(f)};e=["\nbody\n{\nwidth : ",";\nmax-width : ",";\noverflow : hidden;\npadding : 0px;\npadding-bottom : ",";\nmargin : 0px;\nbackground : ",";\ncolor : ",";\n-webkit-touch-callout : none;\n-webkit-user-select : none;\n-webkit-tap-highlight-color : rgba( 255, 255, 255, 0 );\nline-height : 60px;\nfont-size : ","px;\n","\n}\n.separator\n{\ntext-transform : uppercase;\nfont-size : 12px;\ncolor : ",";\nline-height : 13px;\npadding : 8px;\npadding-left : 17px;\nbackground-color : ",";\n}\n#frame\n{\nmargin-top : ","px;\nmargin-bottom : ","px; \n}\n#input\n{\nmargin : 0px;\nheight : ","px;\npadding : 7px;\npadding-left : ",";\nwidth : ","px;\n-webkit-appearance : none;\nopacity : 0;\nbackground-color : #FFF;\nborder : 0px;\nborder-radius : 0px;\nfont-size : 16px;\ncolor : ",";\n}\n.active #input\n{\nheight : ","px;\nwidth : ","px;\noverflow : hidden;\nopacity : 1;\n}\n.createButton\n{\nfont-size : 14px;\nline-height : ","px;\nfont-weight : bold;\ncolor : #FFF;\nmargin : 0px;\nbackground-color : ",";\nborder-radius : 0px;\n-webkit-appearance : none;\ndisplay : none;\nborder : 0px;\nwidth : 80px;\ntext-align : center;\nfloat : right;\nheight : ","px;\n}\n.active .createButton\n{\ndisplay : block;\n}\n.option\n{\nline-height : ","px;\ncolor : ",";\nbackground-color : ",";\nfont-size : 16px;\nfont-weight : normal;\ndisplay : block;\noverflow : hidden;\nwhite-space : nowrap;\ntext-overflow : ellipsis;\npadding-left : ",";\npadding-right : ","; \n","\n}\n.tbordered\n{\nborder-top : 1px solid ",";\n}\n.bbordered\n{\nborder-bottom : 1px solid ",";\n}\n#verb\n{\npadding : ",";\nfont-size : 17px;\nline-height : 21px;\n}\n#object\n{\nfont-weight : bold;\n}\n#action\n{\nfont-size : 12px;\nline-height : 17px;\npadding : ",";\nmargin-bottom : ",";\noverflow : hidden;\nwhite-space : nowrap;\ntext-overflow : ellipsis;\nbackground-color : ",";\n}\n.header .labelHolder\n{\npadding : 5px;\npadding-left : ",";\ndisplay : inline-block;\n}\n.collection\n{\npadding-left : ",";\nbackground-image : url( "," );\nbackground-size : 16px 16px;\nbackground-repeat : no-repeat;\nbackground-position : "," ",";\n}\n",'\n<div id="picker">\n<form onsubmit="done(); return false;">\n<div id="verb">\n<b>Add <span id="object"></span></b>\n<div style="opacity:0.5; font-size:14px">Select or create a collection</div>\n</div>\n<div id="suggestion" class="option touchable tbordered bbordered collection" data-touch-highlight="','" style="margin-bottom:','px">\nSuggestion\n</div>\n<div id="options" class="tbordered">\n<div style="padding-left: ','px">\nLoading collections...\n</div>\n</div>\n<!-- div class="option touchable" data-label="##others" data-touch-highlight="','">Uncategorized</div-->\n<div id="placeholder" class="option bbordered" style="text-transform:none; padding-left : ','; background-color:inherit">\nCreate new collection\n</div>\n<div id="frame">\n<input type="submit" id="createButton" name="createButton" value="Create" class="createButton" /><input id="input" autocorrect="off" autocapitalize="off" type="text" placeholder="" />\n</div>\n<div id="cancel" class="option bbordered tbordered" style="margin-top:','px; background-color:inherit">\nCancel\n</div>\n</form>\n</div>\n',"\n",' <div class="option existing touchable bbordered collection" data-label="','" data-touch-highlight="','">',"</div>\n",'\nSuggestion: <span class="touchable" data-touch-highlight="#4b6a1c" data-action="setInputToSuggestion" style="display: inline-block; padding-left: ',"; padding-right: ",'; text-decoration:underline; border: 1px solid rgba( 255, 255, 255, 0.3 ); border-radius: 3px">','</span>\n<div style="clear:both"></div>\n']
})();"use strict";devhd.extend=function(d,c,b){for(var a in c){if(b==0||b==undefined||d[a]==undefined){d[a]=c[a]}else{if(b!=1){throw new Error("property '"+a+"' already set when extending object")}}}return d};function CW(d,c,a){a=a||OUTER;var b=Math.floor((W-(2*OUTER+(c-1)*a))/c);return d*b+(d-1)*a}function CH(d,c,f,a){a=a||OUTER;var e=SH()-(f||0);var b=Math.floor((e-(2*OUTER+(c-1)*a))/c);
return d*b+(d-1)*a}function SH(){return H-NAVIGATION_BAR-LOCATOR}var T=null;var SETTINGS={};function THEME(){return SETTING("feedly_theme")||"white"}function themable(a){switch(THEME()){case"black":return a+"-black";case"white":default:return a+"-white"}}function TABLET(){return MODE=="tablet"}function IOS(){return SETTING("device_os").indexOf(" ios")>-1||SETTING("device_os").indexOf("iphone")>-1||SETTING("device_os").indexOf("ipad")>-1
}function SVG(){return IOS_7PLUS()||ANDROID_SVG()}function IOS_7PLUS(){return IOS()&&parseFloat(SETTING("device_os_version"))>=7}function IOS_8PLUS(){return IOS()&&parseFloat(SETTING("device_os_version"))>=8}function ANDROID_SVG(){return ANDROID()&&parseFloat(SETTING("device_os_level"))>=19}function ANDROID(){return SETTING("device_os")=="android"}function ANDROID_MED(){return SETTING("device_os")=="android"&&parseFloat(SETTING("device_os_level"))<18
}function ANDROID_LOW(){return SETTING("device_os")=="android"&&parseFloat(SETTING("device_os_level"))<16}function ANDROID_TWO(){return SETTING("device_os")=="android"&&parseFloat(SETTING("device_os_level"))<14}function KINDLE(){return(navigator.userAgent.indexOf("KFTT")>-1||navigator.userAgent.indexOf("Kindle Fire")>-1)}function KINDLE_LOW(){return KINDLE()&&parseFloat(SETTING("device_os_version"))<4.1
}function KINDLE_OLD(){return navigator.userAgent.indexOf("Kindle Fire")>-1}function SOCIAL_GOOGLE_PLUS(){return SETTING("social_google_plus")=="yes"}function FONT(){return"system"}function DP(a){if(a==null){return null}else{return Math.ceil(a/window.devicePixelRatio)}}function faces(a){return fFaces[a]}function family(a){if(feedlyFont[FONT()][a]!=null){return"font-family:"+feedlyFont[FONT()][a]+";"
}else{return"font-family:"+feedlyFont.common[a]+";"}}function SETTING(a){return SETTINGS[a]}function TRACK(b,d,a,c){$B.core.wm.postMessage("parent",{type:"analytics",category:b,action:d,label:a,value:c})}function UPDATE_SETTING(a,b){SETTINGS[a]=b;$B.core.application.setUserSetting(a,b)}function TREAD(a){try{return window.localStorage.getItem(a)}catch(b){$feedly("[TREAD] failed because "+b.name+" -- "+b.message);
return null}}function TWRITE(a,b){try{window.localStorage.setItem(a,b)}catch(c){$feedly("[TWRITE] failed because "+c.name+" -- "+c.message)}}function LREAD(a){try{return SETTING("feedly_local_"+a)}catch(b){$feedly("[LREAD] failed because "+b.name+" -- "+b.message);return null}}function LWRITE(a,b){try{LWRITES({key:b})}catch(c){$feedly("[LWRITE] failed because "+c.name+" -- "+c.message)
}}function LWRITES(f){try{var d={};for(var a in f){var b="feedly_local_"+a;d[b]=SETTINGS[b]=f[a]}$B.core.application.updateUserSettings(d,true)}catch(c){$feedly("[LWRITES] failed because "+c.name+" -- "+c.message)}}function LREMOVE(a){try{LWRITES({key:null})}catch(b){$feedly("[LREMOVE] failed because "+b.name+" -- "+b.message)}}function LREMOVES(b){try{var d={};
for(var a=0;a<b.length;a++){d[b[a]]=null}LWRITES(d)}catch(c){$feedly("[LREMOVES] failed because "+c.name+" -- "+c.message)}}function FAVICON(a){try{if(a==null){return"https://www.google.com/s2/favicons?domain=google.com"}if(a.indexOf("twitter.com")>-1){return"http://twitter.com/favicon.ico"}return"https://www.google.com/s2/favicons?domain="+a.split("/").slice(2,3)+"&alt=feed"
}catch(b){return"https://www.google.com/s2/favicons?domain=google.com"}}function GET(c,e,f,d,i,a){if(d==null){d={}}if(i==null){i=30000}if(a==null){a=0}var j=null;var g=new Date().getTime();var h=new XMLHttpRequest();h.onreadystatechange=function(){if(h.readyState==4){if(j==null){return}if(j!=null){window.clearTimeout(j);j=null}if(h.status==200||h.status==201){e(h.responseText)
}else{if(h.status==0){if(a<2){window.setTimeout(function(){GET(c,e,f,d,i,a+1)},1000)}else{f("Failed to connect to the network")}}else{f(h.status)}}}};j=window.setTimeout(function(){if(j==null){return}window.clearTimeout(j);j=null;f("Failed to connect to the network")},i);h.open("GET",c,true);for(var b in d){h.setRequestHeader(b,d[b])}h.send("")}function POST(b,f,d,e,c,g){if(c==null){c={}
}if(g==null){g=30000}var i=null;var h=new XMLHttpRequest();h.onreadystatechange=function(){if(h.readyState==4){if(i==null){return}if(i!=null){window.clearTimeout(i);i=null}if(h.status==200||h.status==201){d(h.responseText)}else{e(h.status)}}};i=window.setTimeout(function(){if(i==null){return}window.clearTimeout(i);i=null;e("Failed to connect to the network")
},g);h.open("POST",b,true);for(var a in c){h.setRequestHeader(a,c[a])}h.send(f)}function JGET(a,d,b,e,c){GET(a,function(f){d(JSON.parse(f))},b,e,c)}function HINT(a){if(a==null){return}SIGN("[?] "+a)}function SIGN(b,a){if(b==null){return}$B.core.wm.sign(b,a,{})}function image(b){var a=["images/",b];if(window.devicePixelRatio>1){a.push("@2x")}a.push(".png");
return a.join("")}function svg(b){if(IOS_7PLUS()){var a=["images/",b];a.push("~ios");a.push(".svg");return a.join("")}else{if(ANDROID_SVG()){var a=["images/",b];a.push("~android");a.push(".svg");return a.join("")}else{return image(b)}}}function usvg(b){if(SVG()){var a=["images/",b];a.push(".svg");return a.join("")}else{return image(b)}}function findByClass(b,a){if(b==null){return null
}if(b.className!=null&&b.className.indexOf(a)>-1){return b}return null}function element(a){return document.getElementById(a)}function injectCSS(a){var b=document.createElement("style");b.setAttribute("data-injected","yes");b.setAttribute("type","text/css");b.innerText=a;document.getElementsByTagName("head")[0].appendChild(b)}function removeInjectedCSS(){try{var d=document.getElementsByTagName("style");
var b=0;for(var a=0;a<d.length;a++){if(d[a].getAttribute("data-injected")=="yes"){d[a].parentNode.removeChild(d[a]);b++}}return true}catch(c){$feedly("failed to remove injected CSS because "+c.name+" -- "+c.message);return false}}function refreshCSS(){removeInjectedCSS();switch(THEME()){case"black":feedlyTheme=THEME_BLACK;break;case"white":default:feedlyTheme=THEME_WHITE
}T=templates.mobile.activity[ACTIVITY_NAME];if(T!=null&&T.css!=null){injectCSS(T.css())}}function setupActivity(a){try{T=templates.mobile.activity[ACTIVITY_NAME];if(T!=null&&T.css!=null){injectCSS(T.css())}if(T!=null&&T.layout!=null){document.body.className=(document.body.className||"")+" "+SETTING("device_os")+" "+(KINDLE()?"kindle":"");document.body.innerHTML=T.layout(a)
}}catch(b){$feedly("[activity] failed to setup:"+JSON.stringify(a));throw b}}function makeActionable(a){var b=document.body;b.ontouchstart=fastTouchStart;b.ontouchmove=fastTouchMove;b.ontouchend=fastTouchEnd;b.ontouchcancel=fastTouchCancel}var startX;var startY;var maxDeltaX;var maxDeltaY;var touchable=null;var highlightTimer=null;var longTouchTimer=null;
var oldBackground=null;var t0=null;function unhighlightTouchable(){if(touchable==null){return}if(touchable.getAttribute("data-highlight-longer")=="yes"){window.setTimeout(function(){touchable.style.backgroundColor=oldBackground;touchable=null;oldBackground=null},500)}else{touchable.style.backgroundColor=oldBackground;touchable=null;oldBackground=null
}}function fastTouchStart(a){a.preventDefault();a.stopPropagation();t0=new Date().getTime();maxDeltaX=0;maxDeltaY=0;if(longTouchTimer!=null){window.clearTimeout(longTouchTimer);longTouchTimer=null}if(touchable!=null){touchable.style.backgroundColor=oldBackground;touchable=null}startX=a.targetTouches[0].clientX;startY=a.targetTouches[0].clientY;touchable=findByClass(a.targetTouches[0].target,"touchable");
if(touchable!=null){oldBackground=touchable.style.backgroundColor;touchable.style.backgroundColor=touchable.getAttribute("data-touch-highlight")||feedlyTheme.highlight;if(ANDROID()){longTouchTimer=window.setTimeout(function(){if(touchable==null){return}var b=touchable.getAttribute("data-action-hint");if(b!=null){HINT(b)}touchable.style.backgroundColor=oldBackground;
touchable=null},1000)}}}function fastTouchMove(a){a.preventDefault();a.stopPropagation()}function fastTouchEnd(a){a.preventDefault();a.stopPropagation();if(longTouchTimer!=null){window.clearTimeout(longTouchTimer);longTouchTimer=null}if(touchable==null){return}try{onAction(touchable.getAttribute("data-action"),touchable)}catch(b){$feedly("[activity] onAction failed")
}unhighlightTouchable()}function fastTouchCancel(a){if(touchable!=null){touchable.style.backgroundColor=oldBackground;touchable=null;oldBackground=null}}var pickerElem=null;var optionsElem=null;var inputElem=null;var createButtonElem=null;var suggestionElem=null;var objectElem=null;var cancelElem=null;var fingerPrint="";var currentMessage=null;function MAIN(a){try{setupActivity(a);
pickerElem=element("picker");pickerElem.ontouchstart=pickerTouchStart;pickerElem.ontouchmove=pickerTouchMove;pickerElem.ontouchend=pickerTouchEnd;pickerElem.ontouchcancel=pickerTouchCancel;inputElem=element("input");inputElem.onfocus=inputFocus;inputElem.onblur=inputBlur;cancelElem=element("cancel");cancelElem.onclick=cancelActivity;objectElem=element("object");
optionsElem=element("options");createButtonElem=element("createButton");suggestionElem=element("suggestion")}catch(b){$feedly("[categoryPicker] failed MAIN because: "+b.name+" -- "+b.message)}}function ONAPPEVENT(b){switch(b.type){case"wmstartgesture":resetInput();clearHighlightable();inputElem.style.visibility="hidden";break;case"wmbeforehide":resetInput();
clearHighlightable();inputElem.style.visibility="hidden";break;case"visibility":if(b.visible=="hidden"){resetInput();clearHighlightable();inputElem.style.visibility="hidden"}else{resetInput();clearHighlightable();inputElem.style.visibility="visible"}break;case"userSettings":if(SETTINGS==null){SETTINGS=b;feedlyApplicationVersion=SETTING("feedly_app_version")
}else{var a=SETTING("feedly_theme")||initialTheme;SETTINGS=b;var c=SETTING("feedly_theme")||"white";if(c!=a){refreshCSS()}}break;default:break}}function cancelActivity(){resetInput();$B.core.wm.postMessage("parent",{type:"mag",action:"cancelActivity"})}function resetInput(){inputElem.value="";inputElem.blur();pickerElem.className=""}function compareStringProperty(c,b,a){return(new String(b[c]||"").toUpperCase()<new String(a[c]||"").toUpperCase())?-1:1
}function ONEVENT(b){switch(b.type){case"showCategoryPicker":try{currentMessage=b;resetInput();objectElem.innerHTML=T.object(b.title);if(b.suggestion!=null){suggestionElem.innerHTML=b.suggestion;suggestionElem.setAttribute("data-label",b.suggestion);suggestionElem.style.display="block"}else{suggestionElem.innerHTML="";suggestionElem.style.display="none"
}window.scroll(0,0);$B.core.wm.show("self");syncCategoryPicker(b.cats,b.suggestion);var f=document.getElementsByClassName("existing");for(var a=0;a<f.length;a++){var c=f[a];if(c.getAttribute("data-label")==b.suggestion){c.style.display="none"}else{if(c.style.display=="none"){c.style.display="block"}}}}catch(d){$feedly("[category picker] show failed because:"+d.name+" -- "+d.message)
}break;default:}}function syncCategoryPicker(c,a){if(c==null){return}var b=[];if(a==null){b=c}else{for(var d=0;d<c.length;d++){if(c[d].label.toLowerCase()==a.toLowerCase()){continue}b.push(c[d])}}optionsElem.innerHTML=T.layoutOptions(b)}function inputFocus(){pickerElem.className="active"}function inputBlur(){var a=inputElem.value;if(a.length==""){pickerElem.className=""
}}function processClick(b){var a=b.getAttribute("data-label");switch(a){case"##cancel":break;case"##others":categorySelectedCallback();break;default:categorySelectedCallback(a)}return true}var highlightable=null;var startX;var startY;var highlightTimer=null;var oldBackground=null;var maxDeltaX;var maxDeltaY;function findHighlightable(a){if(a==null){return null
}if(a.className!=null&&a.className.indexOf("touchable")>-1){return a}return findHighlightable(a.parentNode)}function clearHighlightable(a){if(a==null){a=false}if(highlightTimer!=null){window.clearTimeout(highlightTimer);highlightTimer=null}if(highlightable==null){return}if(a===true){window.setTimeout(function(){if(highlightable!=null){if(oldBackground!=null){highlightable.style.backgroundColor=oldBackground
}highlightable=null;oldBackground=null}},500)}else{if(highlightable!=null){if(oldBackground!=null){highlightable.style.backgroundColor=oldBackground}highlightable=null;oldBackground=null}}}function pickerTouchStart(a){clearHighlightable();startX=a.targetTouches[0].clientX;startY=a.targetTouches[0].clientY;maxDeltaX=0;maxDeltaY=0;oldBackground=null;highlightable=findHighlightable(a.targetTouches[0].target);
if(highlightable!=null){oldBackground=highlightable.style.backgroundColor;highlightTimer=window.setTimeout(function(){if(highlightable!=null){highlightable.style.backgroundColor=highlightable.getAttribute("data-touch-highlight")||feedlyTheme.highlight}highlightTimer=null},TOUCH_HIGHLIGHT_DELAY)}}function pickerTouchMove(a){if(highlightable==null){return
}clearHighlightable()}function pickerTouchEnd(b){if(highlightable==null){return}var a=processClick(highlightable);clearHighlightable(a)}function pickerTouchCancel(a){clearHighlightable()}function categorySelectedCallback(a){try{var b=devhd.extend(currentMessage,{tag:a,via:"categoryPicker"});if(!a){delete b.tag}var c={type:"mag",action:"doFollow",option:b};
$B.core.wm.postMessage("parent",c)}catch(d){$feedly("[categoryPicker] failed to callback because "+d.name+" -- "+d.message)}}function done(){element("input").blur();var a=element("input").value;if(a.length==""){return}categorySelectedCallback(a)};